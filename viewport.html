<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-orientation" content="landscape">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width,
               initial-scale=1,
               maximum-scale=1,
               user-scalable=no,
               viewport-fit=cover"> 
  <title>Viewport Metrics</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; }
    h1 { font-size: 1.5rem; margin-bottom: 1rem; }
    dl { display: grid; grid-template-columns: max-content 1fr; row-gap: 0.5rem; column-gap: 1rem; }
    dt { font-weight: 600; }
    dd { margin: 0; }
    h2 { margin-top: 2rem; font-size: 1.25rem; }
    #log { list-style: none; padding-left: 0; max-height: 240px; overflow-y: auto; border: 1px solid #ccc; border-radius: 0.5rem; padding: 0.5rem; }
    #log li { font-family: monospace; font-size: 0.85rem; margin: 0.25rem 0; }
  </style>
</head>
<body>
  <h1>Viewport Metrics (auto-updates)</h1>
  <dl>
    <dt>visualViewport.width:</dt><dd id="vvp-w">–</dd>
    <dt>visualViewport.height:</dt><dd id="vvp-h">–</dd>
    <dt>100dvw:</dt><dd id="dvw">–</dd>
    <dt>100dvh:</dt><dd id="dvh">–</dd>
    <dt>100vw:</dt><dd id="vw">–</dd>
    <dt>100vh:</dt><dd id="vh">–</dd>
  </dl>

  <h2>Event log</h2>
  <ul id="log"></ul>

  <!-- Elements used solely for measurement -->
  <div id="measure-d" style="position:absolute;width:100dvw;height:100dvh;pointer-events:none;visibility:hidden;"></div>
  <div id="measure"   style="position:absolute;width:100vw;height:100vh;pointer-events:none;visibility:hidden;"></div>

  <script>
    (function () {
      const els = {
        vvpW: document.getElementById('vvp-w'),
        vvpH: document.getElementById('vvp-h'),
        dvw:  document.getElementById('dvw'),
        dvh:  document.getElementById('dvh'),
        vw:   document.getElementById('vw'),
        vh:   document.getElementById('vh'),
      };
      const measureD = document.getElementById('measure-d');
      const measure  = document.getElementById('measure');
      const logEl = document.getElementById('log');

      function log(msg) {
        const li = document.createElement('li');
        li.textContent = `${new Date().toLocaleTimeString()} — ${msg}`;
        logEl.prepend(li);
        // keep list manageable
        if (logEl.children.length > 100) {
          logEl.removeChild(logEl.lastChild);
        }
      }

      function update() {
        const vvp = window.visualViewport; // no fallback
        els.vvpW.textContent = vvp.width.toFixed(2) + ' px';
        els.vvpH.textContent = vvp.height.toFixed(2) + ' px';

        els.dvw.textContent = measureD.offsetWidth + ' px';
        els.dvh.textContent = measureD.offsetHeight + ' px';

        els.vw.textContent = measure.offsetWidth + ' px';
        els.vh.textContent = measure.offsetHeight + ' px';
      }

      // Helper to bind event -> update + log
      function bind(target, type, label) {
        target.addEventListener(type, () => {
          log(label);
          update();
        }, { passive: true });
      }

      update();
      log('initial update');

      bind(window, 'resize', 'window resize');
      bind(window, 'orientationchange', 'orientationchange');
      bind(window.visualViewport, 'resize', 'visualViewport resize');
    })();
  </script>
</body>
</html>
