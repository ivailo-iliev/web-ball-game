<!doctype html>
<meta name=viewport content="width=device-width,initial-scale=1">
<h2>Broadcast 0 / 1</h2>
<button id=b0>Send 0</button>
<button id=b1>Send 1</button>
<div id=qr></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
const pc = new RTCPeerConnection({iceServers: []});      // host-only candidates
const dc = pc.createDataChannel('bit', {ordered:false,maxRetransmits:0});
document.getElementById('b0').onclick = () => dc.readyState==='open' && dc.send('0');
document.getElementById('b1').onclick = () => dc.readyState==='open' && dc.send('1');

// When ICE completes we export the offer as a QR code
pc.onicegatheringstatechange = async () => {
  if (pc.iceGatheringState !== 'complete') return;
  new QRCode(document.getElementById('qr'), JSON.stringify(pc.localDescription));
};

(async () => {
  await pc.setLocalDescription(await pc.createOffer());
})();

// Paste the answer JSON here after scanning it on the receiver
window.applyAnswer = async json => pc.setRemoteDescription(new RTCSessionDescription(JSON.parse(json)));
</script>